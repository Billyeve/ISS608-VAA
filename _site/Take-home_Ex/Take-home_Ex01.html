<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bryant Philippe Lee">
<meta name="dcterms.date" content="2022-01-22">

<title>ISSS608-VAA - Data Visualization Makeover 01</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1: Programming Elegant DataVis with ggplot2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../Take-home_Ex/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#objective" id="toc-objective" class="nav-link active" data-scroll-target="#objective">Objective</a></li>
  <li><a href="#data-cleaning-and-preparation" id="toc-data-cleaning-and-preparation" class="nav-link" data-scroll-target="#data-cleaning-and-preparation">Data Cleaning and Preparation</a></li>
  <li><a href="#original-visualization" id="toc-original-visualization" class="nav-link" data-scroll-target="#original-visualization">Original Visualization</a></li>
  <li><a href="#visualization-critique" id="toc-visualization-critique" class="nav-link" data-scroll-target="#visualization-critique">Visualization Critique</a>
  <ul class="collapse">
  <li><a href="#clarity" id="toc-clarity" class="nav-link" data-scroll-target="#clarity">Clarity</a>
  <ul class="collapse">
  <li><a href="#a.-lack-of-header-and-titles" id="toc-a.-lack-of-header-and-titles" class="nav-link" data-scroll-target="#a.-lack-of-header-and-titles">a. Lack of Header and Titles</a></li>
  <li><a href="#b.-lack-of-color-labels" id="toc-b.-lack-of-color-labels" class="nav-link" data-scroll-target="#b.-lack-of-color-labels">b. Lack of Color Labels</a></li>
  </ul></li>
  <li><a href="#aesthetic" id="toc-aesthetic" class="nav-link" data-scroll-target="#aesthetic">Aesthetic</a>
  <ul class="collapse">
  <li><a href="#c.-poor-layout" id="toc-c.-poor-layout" class="nav-link" data-scroll-target="#c.-poor-layout">c.&nbsp;Poor Layout</a></li>
  <li><a href="#d.-lack-of-differentiating-color-per-area" id="toc-d.-lack-of-differentiating-color-per-area" class="nav-link" data-scroll-target="#d.-lack-of-differentiating-color-per-area">d.&nbsp;Lack of differentiating color per Area</a></li>
  <li><a href="#e.-too-many-age-groups" id="toc-e.-too-many-age-groups" class="nav-link" data-scroll-target="#e.-too-many-age-groups">e. Too many Age Groups</a></li>
  </ul></li>
  <li><a href="#interactive" id="toc-interactive" class="nav-link" data-scroll-target="#interactive">Interactive</a></li>
  </ul></li>
  <li><a href="#proposed-design-of-trellis-chart" id="toc-proposed-design-of-trellis-chart" class="nav-link" data-scroll-target="#proposed-design-of-trellis-chart">Proposed Design of Trellis Chart</a>
  <ul class="collapse">
  <li><a href="#clarity-1" id="toc-clarity-1" class="nav-link" data-scroll-target="#clarity-1">Clarity</a>
  <ul class="collapse">
  <li><a href="#a.-proper-titles-and-headers" id="toc-a.-proper-titles-and-headers" class="nav-link" data-scroll-target="#a.-proper-titles-and-headers">a. Proper Titles and Headers</a></li>
  <li><a href="#b.-differentiated-color-labels" id="toc-b.-differentiated-color-labels" class="nav-link" data-scroll-target="#b.-differentiated-color-labels">b. Differentiated Color Labels</a></li>
  </ul></li>
  <li><a href="#aesthetic-1" id="toc-aesthetic-1" class="nav-link" data-scroll-target="#aesthetic-1">Aesthetic</a>
  <ul class="collapse">
  <li><a href="#c.-3-column-tabular-trellis-chart" id="toc-c.-3-column-tabular-trellis-chart" class="nav-link" data-scroll-target="#c.-3-column-tabular-trellis-chart">c.&nbsp;3 Column Tabular Trellis Chart</a></li>
  <li><a href="#d.-differentiating-color-per-area" id="toc-d.-differentiating-color-per-area" class="nav-link" data-scroll-target="#d.-differentiating-color-per-area">d.&nbsp;Differentiating Color per Area</a></li>
  <li><a href="#e.-simplified-age-groups" id="toc-e.-simplified-age-groups" class="nav-link" data-scroll-target="#e.-simplified-age-groups">e. Simplified Age Groups</a></li>
  </ul></li>
  <li><a href="#interactive-1" id="toc-interactive-1" class="nav-link" data-scroll-target="#interactive-1">Interactive</a></li>
  </ul></li>
  <li><a href="#process-and-development" id="toc-process-and-development" class="nav-link" data-scroll-target="#process-and-development">Process and Development</a></li>
  <li><a href="#dashboard-overview" id="toc-dashboard-overview" class="nav-link" data-scroll-target="#dashboard-overview">Dashboard Overview</a>
  <ul class="collapse">
  <li><a href="#major-findings" id="toc-major-findings" class="nav-link" data-scroll-target="#major-findings">Major Findings</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Visualization Makeover 01</h1>
<p class="subtitle lead">An Exploration on Singapore’s 2022 Population through Age-Sex Pyramid</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bryant Philippe Lee </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 22, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="objective" class="level1">
<h1>Objective</h1>
<p>The objective is to create <strong>Age-Sex Pyramid Analytic Visualization</strong> to accurately describe the demographic of Singapore. It is a common visual representation to contrast and sub sect the population based on different classifiers, commonly by gender and age. To further illustrate the visualization, multiple Age-Sex Pyramids will be plotted by planning area using the trellis display.&nbsp;</p>
<p>The visualization is created using the <strong><em>Singapore Residents by Planning Area / Sub-zone, Age Group, Sex and Type of Dwelling, June 2022 (Singstat).</em></strong></p>
</section>
<section id="data-cleaning-and-preparation" class="level1">
<h1>Data Cleaning and Preparation</h1>
<p>To ensure that the data is properly loaded and read, the following actions will be done in the raw excel file and tableau.&nbsp;</p>
<table class="table">
<colgroup>
<col style="width: 66%">
<col style="width: 33%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>ACTION</strong></td>
<td><strong>IMAGE</strong></td>
</tr>
<tr class="even">
<td>From the raw excel file, remove the unnecessary rows as not to confuse the tableau reading</td>
<td><img src="images/image-582415093.png" class="img-fluid"></td>
</tr>
<tr class="odd">
<td><p>Link the three sheets with the following identifiers:</p>
<ul>
<li><p>Planning Area</p></li>
<li><p>Subzone</p></li>
<li><p>Age Group</p></li>
<li><p>Type of Dwelling</p></li>
</ul>
<p>Rename 2022 as population (either total, male, female)</p></td>
<td><img src="images/image-2087431466.png" class="img-fluid"></td>
</tr>
</tbody>
</table>
</section>
<section id="original-visualization" class="level1">
<h1>Original Visualization</h1>
<p>Trellis Display is a visualization framework aimed at easily presenting visual data in tables and box subdivided by category. The aim is to be able to compare and contrast the data based on the category in one window.&nbsp;</p>
<p><img src="images/image-2015924300.png" class="img-fluid" width="511"></p>
<p>Though the original visualization is a trellis display, there are some issues on the clarity, aesthetics, and interactive design of the original data visualization to be explained at the next section.&nbsp;</p>
</section>
<section id="visualization-critique" class="level1">
<h1>Visualization Critique</h1>
<p>The issues of the original visualization are as follows:&nbsp;</p>
<section id="clarity" class="level2">
<h2 class="anchored" data-anchor-id="clarity">Clarity</h2>
<section id="a.-lack-of-header-and-titles" class="level3">
<h3 class="anchored" data-anchor-id="a.-lack-of-header-and-titles">a. Lack of Header and Titles</h3>
<p>There is no title to explain the context of the visual. Users would not know the message of the visual at first glance. While an age sex pyramid is a common visual tool to indicate a split in gender population, it is not clear which population is being discussed unless the user is aware of the Planning Areas. Furthermore, though indicated as 2022 at the x-axis, it would have been clearer if it is included in the header or title. A simple title such as 2022 Singapore Age – Sex Pyramid would be enough to communicate the topic of the visual.</p>
</section>
<section id="b.-lack-of-color-labels" class="level3">
<h3 class="anchored" data-anchor-id="b.-lack-of-color-labels">b. Lack of Color Labels</h3>
<p>The color of the back-to-back horizontal bar chart is the same between male and female values. This may confuse users as it may give the wrong impression that both bars may belong to a single elongated bar. It is proposed that color for both male and female to be separate and distinct, even if in the terms of different shade.&nbsp;</p>
</section>
</section>
<section id="aesthetic" class="level2">
<h2 class="anchored" data-anchor-id="aesthetic">Aesthetic</h2>
<section id="c.-poor-layout" class="level3">
<h3 class="anchored" data-anchor-id="c.-poor-layout">c.&nbsp;Poor Layout</h3>
<p>The Trellis chart is organized horizontally and side by side and as such is visually difficult to read as there is an estimated 55 Planning Areas to scroll from. This difficult extends also to comparing multiple charts as there is only so much that can be shown per plane. It is recommended to create a table like trellis chart with rows and columns as to ease visualization and maximize space.&nbsp;</p>
</section>
<section id="d.-lack-of-differentiating-color-per-area" class="level3">
<h3 class="anchored" data-anchor-id="d.-lack-of-differentiating-color-per-area">d.&nbsp;Lack of differentiating color per Area</h3>
<p>Similar to the back to back horizontal bar, the color between planning areas are also the same. To improve aesthetic, it is recommended that Planning Areas will have the same color while male to female bars with share the same color but of different shades.</p>
</section>
<section id="e.-too-many-age-groups" class="level3">
<h3 class="anchored" data-anchor-id="e.-too-many-age-groups">e. Too many Age Groups</h3>
<p>The is an overall 19 age gaps that extends the chart and limits the number of planes that can be shown per window. It is recommended to group together the different age groups from 5 years to 10 years thus reducing the y axis by half and increase the number of charts that can be seen in one viewing.&nbsp;</p>
</section>
</section>
<section id="interactive" class="level2">
<h2 class="anchored" data-anchor-id="interactive">Interactive</h2>
<p>There is an opportunity to create filters to limit and focus the dashboard to a select Area, Subzone and Dwelling Type. This opportunity can allow for a more interactive and dynamic analysis.&nbsp;</p>
</section>
</section>
<section id="proposed-design-of-trellis-chart" class="level1">
<h1>Proposed Design of Trellis Chart</h1>
<p><img src="images/image-1999623995.png" class="img-fluid" width="510"></p>
<section id="clarity-1" class="level2">
<h2 class="anchored" data-anchor-id="clarity-1">Clarity</h2>
<section id="a.-proper-titles-and-headers" class="level3">
<h3 class="anchored" data-anchor-id="a.-proper-titles-and-headers">a. Proper Titles and Headers</h3>
<p>The Age-Sex Pyramid Trellis Chart is titled correctly, indicating as <strong>2022 Singapore Age-Sex Pyramid per Area</strong>. Furthermore, each Age-Sex Pyramid is labeled per Planning Area at the bottom right-hand corner of each plane. These labels ensure that users can properly read and identify the overall message of the chart and category of each individual pyramid.&nbsp;</p>
<p>It may be recommended to add value labels per bar to textually visualize the amount each chart, yet this step can be avoid as the chart allows for pop out labels and values to appear when hovering over the chart. Furthermore, on the design aspect, value labels will clutter the chart and cause it to be overly noisy.&nbsp;</p>
</section>
<section id="b.-differentiated-color-labels" class="level3">
<h3 class="anchored" data-anchor-id="b.-differentiated-color-labels">b. Differentiated Color Labels</h3>
<p>Male-Female bar colors are identified with different shades with the lighter colors indicating male and darker as female. This ensures visual differentiation between genders with ensuring some similarity within planning area.</p>
</section>
</section>
<section id="aesthetic-1" class="level2">
<h2 class="anchored" data-anchor-id="aesthetic-1">Aesthetic</h2>
<section id="c.-3-column-tabular-trellis-chart" class="level3">
<h3 class="anchored" data-anchor-id="c.-3-column-tabular-trellis-chart">c.&nbsp;3 Column Tabular Trellis Chart</h3>
<p>The Trellis Chart is organized to 3 columns to ensure that the pyramids are visually maximized both in terms of the number of pyramid charts in one viewing and the max value of the y-axis for the bars to be visually district.</p>
</section>
<section id="d.-differentiating-color-per-area" class="level3">
<h3 class="anchored" data-anchor-id="d.-differentiating-color-per-area">d.&nbsp;Differentiating Color per Area</h3>
<p>Colors per Planning Area is colored differently to ensure distinct differentiation per pyramid.&nbsp;</p>
</section>
<section id="e.-simplified-age-groups" class="level3">
<h3 class="anchored" data-anchor-id="e.-simplified-age-groups">e. Simplified Age Groups</h3>
<p>19 age groups are reduced to 10 age groups to visually maximize the space of the plane without oversimplifying the data points.&nbsp;</p>
</section>
</section>
<section id="interactive-1" class="level2">
<h2 class="anchored" data-anchor-id="interactive-1">Interactive</h2>
<p>The Trellis Chart can be filtered per Planning Area, Subzone and Type of Dwelling. This ensures interactive use of the chart and allow for more drilled down analysis of the data. Though there is a <em>limitation as this chart cannot compare Subzones within the same Planning Area as can be an improvement for future developments.</em>&nbsp;</p>
</section>
</section>
<section id="process-and-development" class="level1">
<h1>Process and Development</h1>
<table class="table">
<colgroup>
<col style="width: 85%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>ACTION</th>
<th>IMAGE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>To create the Trellis Chart, the table must be created first determining the number of columns, indicated in the parameter - <strong># of Col</strong></td>
<td><img src="images/image-1064192840.png" class="img-fluid"></td>
</tr>
<tr class="even">
<td><p>Next is to define the rows and columns field with the following formula:</p>
<ul>
<li><p>Index – Index ()</p></li>
<li><p>Column – [Index]%[# of Col]</p></li>
<li><p>Rows – int(([Index]-1)/[# of Col])</p></li>
</ul>
<p>Then place the calculated values at the column and row fields</p></td>
<td><img src="images/image-1046358763.png" class="img-fluid"></td>
</tr>
<tr class="odd">
<td><p>To ensure that the values are not inflated due to the addition of the <strong>Total</strong> category, recreate the set of the following dimensions by excluding the <strong>Total</strong> and <strong>HDB Total</strong> (for Type of Dwelling)</p>
<ul>
<li><p>Planning Area</p></li>
<li><p>Subzone</p></li>
<li><p>Type of Dwelling</p></li>
</ul></td>
<td><img src="images/image-1614902722.png" class="img-fluid"></td>
</tr>
<tr class="even">
<td><p>Build the Trellis Chart with multiple Age-Sex Pyramid with the correct filters</p>
<p><em>*remember to set the colors base on the gender and planning area</em></p></td>
<td><img src="images/image-322762394.png" class="img-fluid"></td>
</tr>
<tr class="odd">
<td>Create a <strong>0 mark</strong> parameter to as a line with Planning Area as the label. Set the <strong>0 mark</strong> as a dual axis and make the line transparent to set the Planning Area label</td>
<td><img src="images/image-350269135.png" class="img-fluid"></td>
</tr>
</tbody>
</table>
</section>
<section id="dashboard-overview" class="level1">
<h1>Dashboard Overview</h1>
<p>Besides the Trellis Chart, additional charts are created as well to build a better interactive dashboard. Page 1 of the dashboard is to give an overview of Singapore 2022 population while Page 2 presents the Trellis Chart and Age-Sex Pyramids per Planning Area.&nbsp;</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Page 1</th>
<th style="text-align: center;">Page 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="images/image-1046360946.png" class="img-fluid"></td>
<td style="text-align: center;"><img src="images/image-103319897.png" class="img-fluid"></td>
</tr>
</tbody>
</table>
<section id="major-findings" class="level2">
<h2 class="anchored" data-anchor-id="major-findings">Major Findings</h2>
<ul>
<li><p><strong>Overall, Singapore has more females than males by est. 500,000 heavily contributed by the adult (25 and above) age group.</strong> Male population is 11 million while Female is 11.5 million. This is a stark contrast from previous years as there are more males in Singapore than females, average ratio at 53% male and 47% female. The shift in population shares maybe due to migration and the impact of COVID lockdown as male manpower migrating to the city state decreased during COVID and has not recovered since.&nbsp;</p></li>
<li><p><strong>Male and Female distribution per Planning Area and age group are almost equal except for the senior population.</strong> The close distribution maybe due to the equal economic opportunity for both genders in Singapore. Furthermore, top areas that are heavily populated by males are populated by females as well.&nbsp;</p></li>
<li><p><strong>The data may be incomplete as 26 out of 55 (48%) of Total Planning Area have either no data or negligible data.</strong> This is evident that some area's population data is missing and is not only limited to far east and far west areas such as Tuas, but high population city center such as Orchard has no data recorded as well.&nbsp;</p></li>
</ul>
<p>Dashboard Link:</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>